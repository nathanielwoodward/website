<!DOCTYPE html>
<html lang="en">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.60.1" />

    
    
    

<title>Monty Hall Explanation • Nathaniel Woodward</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Monty Hall Explanation"/>
<meta name="twitter:description" content="The Monty Hall Problem is Very Counterintuitive  If you still don’t believe it, you are in good company:       Simplest Explanation  Your first choice has a 1/3 chance of having the car So there’s a 2/3 it is behind one of the other doors     Monty will never open the door with the car behind it After he opens a door, the entire 2/3 probability shifts to the other closed door     Monty is Key!"/>

<meta property="og:title" content="Monty Hall Explanation" />
<meta property="og:description" content="The Monty Hall Problem is Very Counterintuitive  If you still don’t believe it, you are in good company:       Simplest Explanation  Your first choice has a 1/3 chance of having the car So there’s a 2/3 it is behind one of the other doors     Monty will never open the door with the car behind it After he opens a door, the entire 2/3 probability shifts to the other closed door     Monty is Key!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/montyhallexp/" />
<meta property="og:site_name" content=" " />


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">








<link rel="stylesheet" href="/scss/hyde-hyde.43109490338b28cdd7a74845262efe59bf66fdc3530f5e818a66c9a579a79080.css" integrity="sha256-QxCUkDOLKM3Xp0hFJi7&#43;Wb9m/cNTD16BimbJpXmnkIA=">


<link rel="stylesheet" href="/scss/print.8c61428a4ae8b36c028e9198876312a2de5a2b3c80bbbdcceb98d738691c4f6b.css" integrity="sha256-jGFCikros2wCjpGYh2MSot5aKzyAu73M65jXOGkcT2s=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    
    <script type="text/javascript"
   src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script type="text/javascript" src="/js/bigfoot.min.js"></script>
<script type="text/javascript">
    $.bigfoot();
</script>

</head>


    <body class="theme-base-09 ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
    
      
        
        
        
        
        <div class="author-image">
           <a href="/"><img src="/img/headshot_cropped_f2019.png" alt="Nathaniel Woodward" class="img--circle img--headshot element--center"></a>
        </div>
        
      
      <p class="site__description">
      <a href="mailto:nathanielraley@gmail.com"> Nathaniel Woodward 
      </a></p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Nathaniel Woodward</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/about/">
						<span>About</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/portfolio/">
						<span>Portfolio</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/teaching/">
						<span>Teaching</span>
					</a>
				</li>
			 
		 
			 
				<li>
					<a href="/resume.html">
						<span>Vitae</span>
					</a>
				</li>
			 
		
	</ul>
</div>

        <br>
        <section class="social">
	
	<a href="https://twitter.com/Distributino" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	<a href="https://github.com/nathanielwoodward" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="https://linkedin.com/in/nathanielraley" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	<a href="https://last.fm/user/ramimba" rel="me"><i class="fab fa-lastfm fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2022  
  
    <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>
  
</div>



  </div>
</div>

        <div class="content container">
            
    
<article>
  <header>
    <h1>Monty Hall Explanation</h1>
    
    
<div class="post__meta">
    
    
    
    
    
    
    <br/>
    <i class="fas fa-clock"></i> 6 min read
</div>


  </header>
  
  
  <div class="post">
    


<div id="the-monty-hall-problem-is-very-counterintuitive" class="section level2">
<h2>The Monty Hall Problem is Very Counterintuitive</h2>
<ul>
<li>If you still don’t believe it, you are in good company:</li>
</ul>
<center>
<img src="/erdos.png" />
</center>
<center>
<img src="/erdos_montyhall.jpg" width="250" />
</center>
</div>
<div id="simplest-explanation" class="section level2">
<h2>Simplest Explanation</h2>
<ul>
<li>Your first choice has a 1/3 chance of having the car</li>
<li>So there’s a 2/3 it is behind one of the other doors</li>
</ul>
<center>
<img src="/monty1.png" />
</center>
<ul>
<li>Monty will never open the door with the car behind it</li>
<li>After he opens a door, the entire 2/3 probability shifts to the other closed door</li>
</ul>
<center>
<img src="/monty2.png" />
</center>
</div>
<div id="monty-is-key" class="section level2">
<h2>Monty is Key!</h2>
<ul>
<li><p>Imagine you chose door 1, and you are asked whether you want the prize behind door 1 or <em>the better of</em> the prizes behind doors 2 and 3</p></li>
<li><p>This is exactly what you get when you switch (because Monty always removes the worse prize of the two when he opens a door)!</p></li>
</ul>
</div>
<div id="another-appeal-to-intuition" class="section level2">
<h2>Another Appeal to Intuition</h2>
<ul>
<li>Imagine there are 100 doors, 99 goats, and 1 car</li>
<li>You pick a door, so you have a 1/100 chance of winning the car</li>
<li>Then Monty opens 98 of the doors revealing 98 of the goats</li>
<li><p>There is still one other unopened door: Should you switch?</p></li>
<li>If you pick a goat on your first choice (99/100), you will always get the car if you switch</li>
<li><p>By switching, you only get a goat if you had the car at first, and that’s super rare (1/100)</p></li>
</ul>
</div>
<div id="more-involved-and-more-satisfying-explanation" class="section level2">
<h2>More Involved (and More Satisfying) Explanation</h2>
<div id="consider-the-following-scenario" class="section level3">
<h3>Consider the Following Scenario:</h3>
<ul>
<li>Say <strong>you pick door 1</strong> and then <strong>Monty opens door 3</strong></li>
<li><p>Should you stay with door 1 or switch to door 2?</p></li>
<li><p>Before Monty opened door 3, the car had a <span class="math inline">\(1/3\)</span> chance of being behind each door</p></li>
</ul>
<p><span class="math display">\[
p(car1)=\frac 13,\ \ \ p(car2)= \frac 13, \ \ \ p(car3)=\frac 13
\]</span></p>
<ul>
<li><p>But Monty is not opening doors at random: He will <em>always</em> open a goat door (and never the car)!</p></li>
<li><p>What is the probability Monty opens door 3, the true location of the car?</p></li>
<li><p>If you were right initially (the car is actually behind door 1), Monty can open either door 2 or door 3 (and picks one at random):</p></li>
</ul>
<p><span class="math display">\[
p(open3 \mid car 1) = \frac 12 \\
\text{(in words: the probability Monty opens #3 given that the car is behind #1 is 1/2)}
\]</span></p>
<ul>
<li>However, if you chose door 1 and the car is behind door 2, Monty has no choice but to open door 3!</li>
</ul>
<p><span class="math display">\[
p(open3 \mid car2) = 1
\]</span></p>
<ul>
<li>Finally, if you chose door 1 and the car is behind door 3, Monty cannot open door three without revealing the car! This has no chance of happening.</li>
</ul>
<p><span class="math display">\[
p(open3 \mid car3) = 0
\]</span></p>
</div>
</div>
<div id="bayes-rule" class="section level2">
<h2>Bayes’ Rule</h2>
<ul>
<li>OK, so you chose door 1 and then monty opened door 3</li>
<li><p>What are the chances that the car is behind door 2 (i.e., should you switch)?</p></li>
<li>We are interested in <span class="math inline">\(p(car2 \mid open3)\)</span></li>
<li><p>From above, we already have the flip of it, but this is not the same: <span class="math inline">\(p(open3 \mid car2)\)</span></p></li>
<li><p>We can turn it around using Bayes’ rule, which states that</p></li>
</ul>
<p><span class="math display">\[
p(A\mid B)=\frac{p(A)p(B\mid A)}{p(B)}
\]</span></p>
<p>In our case,</p>
<p><span class="math display">\[
p(car2 \mid open3)=\frac{p(car2)p(open3 \mid car2)}{p(open3)}
\]</span></p>
<ul>
<li>We already have the two pieces in the numerator (from above):</li>
</ul>
<p><span class="math display">\[
p(car2 \mid open3)=\frac{(\frac 13 )\left(1\right)}{p(open3)}
\]</span></p>
<ul>
<li>We just need the denominator (the probability Monty opens door 3)</li>
<li>We can get this by adding together the probabilities of all the different situations in which Monty opens door 3 (this is the Law of Total Probability):</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
p(open3)&amp;=p(open3\ \&amp; \ car1)+p(open3\ \&amp; \ car2)+p(open3\ \&amp; \ car3)\\
&amp;=p(car1)p(open3 \mid car1)+p(car2)p(open3 \mid car2)+p(car3)p(open3 \mid car3)\\
&amp;=(\frac13)(\frac 12)+(\frac13)(1)+(\frac13)(0)\\
&amp;=(\frac16)+(\frac13)+(0)\\
&amp;=\frac 12
\end{aligned}
\]</span></p>
<ul>
<li>Now we have the denominator, so</li>
</ul>
<p><span class="math display">\[
p(car2 \mid open3)=\frac{(\frac 13 )\left(1\right)}{(\frac12)}=2/3
\]</span></p>
<ul>
<li><p>This tells us that, if we picked door 1 and Monty opened door 3, then there is a <span class="math inline">\(\frac23\)</span> chance that the car is behind door 2</p></li>
<li><p>That means there is only a <span class="math inline">\(\frac13\)</span> chance the car is behind door 1 (let’s use Bayes’ rule again)</p></li>
</ul>
<p><span class="math display">\[
p(car1 \mid open3)=\frac{(\frac 13 )(\frac 12)}{(\frac12)}=1/3
\]</span></p>
<ul>
<li><p>Thus, we would be much better off switching!</p></li>
<li><p>This will be true no matter which door you pick initially!</p></li>
</ul>
<pre class="r"><code># The probability the car is behind door 1, door 2, and door 3 is initially 1/3

car1 &lt;- 1/3
car2 &lt;- 1/3
car3 &lt;- 1/3

# Say you choose door 1

# Monty will never open the door with the car behind it (!)
# What is the probability Monty opens door 3, given your choice (door 1) and the actual location of the car?

open3_car1 &lt;- 1/2 #if the car was behind 1 (your door), he could open either goat door 2 or 3 
open3_car2 &lt;- 1 #if you chose 1, and the car&#39;s behind 2, he has to open 3
open3_car3 &lt;- 0 #if you chose 1, and the car is behind 3, he cannot open 3

## Monty is CERTAIN to open door 3 if the car is behind door 2
## Monty is only 50:50 to open door 3 if the car is behind door 1
## Monty will NEVER open door 3 if the car is behind it

## Say Monty opens door 3, revealing a goat.

## What is the probability that the car is behind door 1, given door 3 was opened? 
## (What is the probability your initial choice was correct)?

car1 * open3_car1 / (car1*open3_car1 + car2*open3_car2 + car3*open3_car3)</code></pre>
<pre><code>## [1] 0.3333333</code></pre>
<pre class="r"><code>## What is the probability that the car is behind door 2, given door 3 was opened?
## (What is the probability that the other unopened door has the car?)

car2 * open3_car2 / (car1*open3_car1+car2*open3_car2+car3*open3_car3)</code></pre>
<pre><code>## [1] 0.6666667</code></pre>
<p>We can simulate this in R too (you can edit/run the code below):</p>
<pre class="r"><code>#randomly assign cars and goats

doors &lt;- sample(c(&quot;goat&quot;,&quot;goat&quot;,&quot;car&quot;))

#you pick door 1 (below you can change it to whatever you want)!

yours &lt;- 1

others &lt;- doors[-yours]
  
if(others[1]==&quot;goat&quot; &amp; others[2]==&quot;goat&quot;){
  open &lt;- sample(c(1,2),size=1)
} else if(others[1]==&quot;goat&quot; &amp; others[2]!=&quot;goat&quot;){
  open &lt;- 1
} else {
  open &lt;- 2
}

open=ifelse(yours==1,open+1,ifelse(yours==3,open,ifelse(yours==2,floor(open*3/2))))

print(paste(&quot;Monty opened door&quot;,open,&quot;revealing a&quot;,doors[open]))</code></pre>
<pre><code>## [1] &quot;Monty opened door 3 revealing a goat&quot;</code></pre>
<pre class="r"><code>print(paste(&quot;If you kept your original door:&quot;, doors[1]))</code></pre>
<pre><code>## [1] &quot;If you kept your original door: goat&quot;</code></pre>
<pre class="r"><code>print(paste(&quot;If you switched:&quot;, doors[!c(1,2,3)%in%c(yours,open)]))</code></pre>
<pre><code>## [1] &quot;If you switched: car&quot;</code></pre>
<pre class="r"><code>######################################

##Simulate the game 5000 times

results &lt;- replicate(n = 5000, {
  
  doors &lt;- sample(c(&quot;goat&quot;,&quot;goat&quot;,&quot;car&quot;))
  yours &lt;- 2
  others &lt;- doors[-yours]
  
  if(others[1]==&quot;goat&quot; &amp; others[2]==&quot;goat&quot;){
    open &lt;- sample(c(1,2),size=1)
  } else if(others[1]==&quot;goat&quot; &amp; others[2]!=&quot;goat&quot;){
    open &lt;- 1
  } else open &lt;- 2

open &lt;- ifelse(yours==1,open+1,ifelse(yours==3,open,ifelse(yours==2,floor(open*3/2))))

return(c(stay=doors[yours], switch=doors[!c(1,2,3)%in%c(yours,open)]))
})

#full results
head(t(results))</code></pre>
<pre><code>##      stay   switch
## [1,] &quot;goat&quot; &quot;car&quot; 
## [2,] &quot;car&quot;  &quot;goat&quot;
## [3,] &quot;goat&quot; &quot;car&quot; 
## [4,] &quot;car&quot;  &quot;goat&quot;
## [5,] &quot;goat&quot; &quot;car&quot; 
## [6,] &quot;goat&quot; &quot;car&quot;</code></pre>
<pre class="r"><code>#proportions if you stay
table(t(results)[,1])/5000</code></pre>
<pre><code>## 
##    car   goat 
## 0.3322 0.6678</code></pre>
<pre class="r"><code>#proportions if you switch
table(t(results)[,2])/5000</code></pre>
<pre><code>## 
##    car   goat 
## 0.6678 0.3322</code></pre>
<div id="try-it" class="section level3">
<h3>Try it!</h3>
<p><br>
<br>
<iframe width='100%' height='300' src='https://rdrr.io/snippets/embed/?code=%23randomly%20assign%20cars%20and%20goats%0A%0Adoors%20%3C-%20sample(c(%22goat%22%2C%22goat%22%2C%22car%22))%0A%0A%23you%20pick%20door%201%20(change%20it%20to%20whatever%20you%20want)!%0A%0Ayours%20%3C-%201%0A%0Aothers%20%3C-%20doors%5B-yours%5D%0A%20%20%0Aif(others%5B1%5D%3D%3D%22goat%22%20%26%20others%5B2%5D%3D%3D%22goat%22)%7B%0A%20%20open%20%3C-%20sample(c(1%2C2)%2Csize%3D1)%0A%7D%20else%20if(others%5B1%5D%3D%3D%22goat%22%20%26%20others%5B2%5D!%3D%22goat%22)%7B%0A%20%20open%20%3C-%201%0A%7D%20else%20%7B%0A%20%20open%20%3C-%202%0A%7D%0A%0Aopen%3Difelse(yours%3D%3D1%2Copen%2B1%2Cifelse(yours%3D%3D3%2Copen%2Cifelse(yours%3D%3D2%2Cfloor(open*3%2F2))))%0A%0A%0Aprint(paste(%22Monty%20opened%20door%22%2Copen%2C%22revealing%20a%22%2Cdoors%5Bopen%5D))%0Aprint(paste(%22If%20you%20kept%20your%20original%20door%3A%22%2C%20doors%5B1%5D))%0Aprint(paste(%22If%20you%20switched%3A%22%2C%20doors%5B!c(1%2C2%2C3)%25in%25c(yours%2Copen)%5D))%0A%0Aprint(%22BEGIN%20SIMULATION%22)%0A%0Aprint(%22Simulate%20the%20game%205000%20times%22)%0A%0Aresults%20%3C-%20replicate(n%20%3D%205000%2C%20%7B%0A%20%20%0A%20%20doors%20%3C-%20sample(c(%22goat%22%2C%22goat%22%2C%22car%22))%0A%20%20yours%20%3C-%202%0A%20%20others%20%3C-%20doors%5B-yours%5D%0A%20%20%0A%20%20if(others%5B1%5D%3D%3D%22goat%22%20%26%20others%5B2%5D%3D%3D%22goat%22)%7B%0A%20%20%20%20open%20%3C-%20sample(c(1%2C2)%2Csize%3D1)%0A%20%20%7D%20else%20if(others%5B1%5D%3D%3D%22goat%22%20%26%20others%5B2%5D!%3D%22goat%22)%7B%0A%20%20%20%20open%20%3C-%201%0A%20%20%7D%20else%20open%20%3C-%202%0A%0Aopen%20%3C-%20ifelse(yours%3D%3D1%2Copen%2B1%2Cifelse(yours%3D%3D3%2Copen%2Cifelse(yours%3D%3D2%2Cfloor(open*3%2F2))))%0A%0Areturn(c(stay%3Ddoors%5Byours%5D%2C%20switch%3Ddoors%5B!c(1%2C2%2C3)%25in%25c(yours%2Copen)%5D))%0A%7D)%0A%0A%23full%20results%0Ahead(t(results))%0A%0Aprint(%22proportions%20if%20you%20stay%22)%0Atable(t(results)%5B%2C1%5D)%2F5000%0A%0Aprint(%22proportions%20if%20you%20switch%3A%22)%0Atable(t(results)%5B%2C2%5D)%2F5000%0A' frameborder='0'></iframe></p>
</div>
</div>

  </div>
  


<div class="navigation navigation-single">
    
    <a href="/music/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">Music</span>
    </a>
    
    
    <a href="/karaoke/" class="navigation-next">
      <span class="navigation-title">Karaoke</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    


</article>


        </div>
        
    

<script defer src="https://use.fontawesome.com/releases/v5.5.0/js/all.js" integrity="sha384-GqVMZRt5Gn7tB9D9q7ONtcp4gtHIUEW/yG7h98J7IpE3kpi+srfFyyB/04OV6pG0" crossorigin="anonymous"></script>


    
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
    
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    




    



    </body>
</html>
